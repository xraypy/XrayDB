<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Example Calculations of X-ray properties of materials &#8212; X-ray DB:  X-ray Reference Data in SQLite</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=0f882399" />
    <script src="_static/documentation_options.js?v=a284863f"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using XrayDB from Python" href="python.html" />
    <link rel="prev" title="X-ray Periodic Table of the Elements" href="periodictable.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="python.html" title="Using XrayDB from Python"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="periodictable.html" title="X-ray Periodic Table of the Elements"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">X-ray DB:  X-ray Reference Data in SQLite</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Example Calculations of X-ray properties of materials</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="example-calculations-of-x-ray-properties-of-materials">
<span id="example-calcs"></span><h1>Example Calculations of X-ray properties of materials<a class="headerlink" href="#example-calculations-of-x-ray-properties-of-materials" title="Link to this heading">¶</a></h1>
<p>A few detailed examples of using the <cite>xraydb.sqlite</cite> to calculate the X-ray
properties of materials are presented here.  These all use the functions in the
python <cite>xraydb</cite> module, which is describe in more detail in the next chapter,
<a class="reference internal" href="python.html#python-api"><span class="std std-ref">Using XrayDB from Python</span></a>.  The examples will explore some aspects of X-ray physics,
but will not give a complete tutorial on the concepts here.  For a good
reference on X-ray physics, see <span id="id1">[<a class="reference internal" href="biblio.html#id2" title="J. Als-Nielsen and D. McMorrow. Elements of Modern X-ray Physics, 2nd Edition. John Wiley &amp; Sons, 2011. URL: https://dx.doi.org/10.1002/9781119998365.">Als-Nielsen and McMorrow (2011)</a>]</span>.</p>
<p>Many of these calculations are also available at <a class="reference external" href="https://xraydb.xrayabsorption.org/">XrayDB Web App (xrayabsorption.org)</a>.</p>
<section id="x-ray-attenuation-by-elements">
<h2>X-ray attenuation by elements<a class="headerlink" href="#x-ray-attenuation-by-elements" title="Link to this heading">¶</a></h2>
<p>The XrayDB database tabulates values of the X-ray mass attenuation
coefficient, <span class="math notranslate nohighlight">\(\mu/\rho\)</span>, for each element.  In most of the X-ray
regime used in materials characterization (say, up to 150 keV), the
photo-electric effect is the main process that causes X-ray attenuation.
When the photo-electric process is dominant, the values for
<span class="math notranslate nohighlight">\(\mu/\rho\)</span> depends strongly on <em>Z</em> of the atom and on X-ray energy
<em>E</em>.  In addition to these strong dependencies, sharp increases –
so-called absorption edges – with be see at energies of bound core
electron levels of atoms.  To illustrate these characteristics, the
following script will plot <span class="math notranslate nohighlight">\(\mu/\rho\)</span> for selected elements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># XrayDB example script python/examples/mu_elements.py</span>
<span class="c1">#</span>
<span class="c1"># plot X-ray mass attenuation for selected elements</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">wxmplot.interactive</span> <span class="k">as</span> <span class="nn">wi</span>
<span class="kn">from</span> <span class="nn">xraydb</span> <span class="kn">import</span> <span class="n">mu_elam</span> <span class="p">,</span> <span class="n">atomic_symbol</span>

<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">120000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># energy in eV</span>
      
<span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_elam</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">elem</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;X-ray mass attenuation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu/\rho \rm\, (cm^2/gr)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id4">
<span id="fig-mu-depth"></span><a class="reference external image-reference" href="_images/mu_elements.png"><img alt="_images/mu_elements.png" src="_images/mu_elements.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">X-ray mass attenuation coefficient for C, Cu, and Au.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>As you can see in Figure from this figure, the attenuation drops very
strongly with <span class="math notranslate nohighlight">\(E\)</span> – approximately as <span class="math notranslate nohighlight">\(E^3\)</span>. <span class="math notranslate nohighlight">\(\mu\)</span> also
depends strongly with <em>Z</em>, though the sharp absorption edges make this more
complicated.</p>
<p>You can also observe that at relatively high energies for relatively low-Z
elements (such as C above about 20 keV) that the attenuation levels off.
This is because the coherent (Rayleigh) and incoherent (Compton) scattering
processes dominate, so that the photo-electric absorption is no longer the
dominant X-ray scattering process.  This can be illustrated by plotting the
different components of <span class="math notranslate nohighlight">\(\mu/\rho\)</span> for C, as with the following script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># XrayDB example script python/examples/mu_components_C.py</span>
<span class="c1">#</span>
<span class="c1"># plot components of X-ray mass attenuation for C </span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">xraydb</span> <span class="kn">import</span> <span class="n">mu_elam</span> 

<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">120000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># energy in eV</span>
      
<span class="n">elem</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span>
<span class="n">mu_total</span> <span class="o">=</span> <span class="n">mu_elam</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">)</span>
<span class="n">mu_photo</span> <span class="o">=</span> <span class="n">mu_elam</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;photo&#39;</span><span class="p">)</span>
<span class="n">mu_incoh</span> <span class="o">=</span> <span class="n">mu_elam</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;incoh&#39;</span><span class="p">)</span>
<span class="n">mu_coher</span> <span class="o">=</span> <span class="n">mu_elam</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;coh&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;X-ray mass attenuation for </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">elem</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu_total</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu_photo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Photo-electric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu_incoh</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Incoherent&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu_coher</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Coherent&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu/\rho \rm\, (cm^2/gr)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>which will generate the following plot:</p>
<figure class="align-center" id="id5">
<span id="fig-mu-components-c"></span><a class="reference external image-reference" href="_images/mu_components_C.png"><img alt="_images/mu_components_C.png" src="_images/mu_components_C.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">X-ray scattering and attenuation factors for C.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Note that above 20 keV, the photo-electric absorption and incoherent
Compton contributions are about equal, and that the Compton scattering
dominates above 50 keV.  As shown above, the photo-electric scattering will
be much higher for heavier elements. The Rayleigh and Compton scattering
have a much weaker dependence on <em>Z</em>, so that the photo-electric process
dominates to higher energies.  Replacing ‘C’ with ‘Fe’ in the script above
will generate the following plot:</p>
<figure class="align-center" id="id6">
<span id="fig-mu-components-fe"></span><a class="reference external image-reference" href="_images/mu_components_Fe.png"><img alt="_images/mu_components_Fe.png" src="_images/mu_components_Fe.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">X-ray scattering and attenuation factors for Fe.</span><a class="headerlink" href="#id6" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>which shows that the Compton scattering reaching about 0.1 to 0.25
<span class="math notranslate nohighlight">\(\rm cm^2/gr\)</span> for Fe, about the same value as it was for C, while the
photo-electric cross-section dominates past 100 keV.</p>
</section>
<section id="mu-calculations-for-materials">
<h2><span class="math notranslate nohighlight">\(\mu\)</span> calculations for materials<a class="headerlink" href="#mu-calculations-for-materials" title="Link to this heading">¶</a></h2>
<p>While one can use the above values for <span class="math notranslate nohighlight">\(\mu/\rho\)</span> to calculate the
attenuation of X-rays by multi-element materials, the <a class="reference internal" href="python.html#xraydb.material_mu" title="xraydb.material_mu"><code class="xref py py-func docutils literal notranslate"><span class="pre">material_mu()</span></code></a>
function is available to do the more convenient calculation of the X-ray
absorption coefficient <span class="math notranslate nohighlight">\(\mu\)</span> in units of 1/cm for a material and
energy value and density (which are known for several common materials).
This gives the length for which X-ray intensity is reduced by a factor of
<em>e</em>, and so can be used to calculate the fraction of the X-rays transmitted
through a material of known thickness, as <span class="math notranslate nohighlight">\(\exp(-t\mu)\)</span> for a
material of thickness <em>t</em>.  As a first example, we calculate the the
fraction of X-ray transmitted through 1 mm of the water as a function of
X-ray energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># XrayDB example script    python/examples/mu_water.py</span>
<span class="c1">#</span>
<span class="c1"># calculate the fraction of X-rays transmitted through 1 mm of water</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">xraydb</span> <span class="kn">import</span> <span class="n">material_mu</span>

<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">41000</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">material_mu</span><span class="p">(</span><span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>

<span class="c1"># mu is returned in 1/cm</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">trans</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;transmitted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">trans</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;attenuated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;X-ray absorption by 1 mm of water&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Transmitted / Attenuated fraction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id7">
<span id="fig-mu-water"></span><a class="reference external image-reference" href="_images/mu_water.png"><img alt="_images/mu_water.png" src="_images/mu_water.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Fraction of X-rays absorbed and transmitted by water</span><a class="headerlink" href="#id7" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>replacing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">material_mu</span><span class="p">(</span><span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>
</pre></div>
</div>
<p>with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">material_mu</span><span class="p">(</span><span class="s1">&#39;CaCO3&#39;</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">2.71</span><span class="p">)</span>
</pre></div>
</div>
<p>would generate the following plot</p>
<figure class="align-center" id="id8">
<span id="fig-mu-calcite"></span><a class="reference external image-reference" href="_images/mu_calcite.png"><img alt="_images/mu_calcite.png" src="_images/mu_calcite.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Fraction of X-rays absorbed and transmitted by calcite</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>For many X-ray experiments, selecting the size of a material size so that
its thickness is approximately 1 to 2 absorption length is convenient so
that X-ray scattering and emission can be observed strongly, with neither
all primary and scattered X-rays being absorbed by the material itself, but
also not simply passing through the material without any interaction.  For
example, one can simply do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xraydb</span> <span class="kn">import</span> <span class="n">material_mu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu_20kev</span> <span class="o">=</span> <span class="n">xraydb</span><span class="o">.</span><span class="n">material_mu</span><span class="p">(</span><span class="s1">&#39;CaCO3&#39;</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">2.71</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CaCO3 1/e depth at 20keV = </span><span class="si">{:.3f}</span><span class="s2"> mm&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="n">mu_20kev</span><span class="p">))</span>
<span class="go">CaCO3 1/e depth at 20keV = 0.648 mm</span>
</pre></div>
</div>
</section>
<section id="x-ray-flux-calculations-for-ionization-chambers-and-photodiodes">
<h2>X-ray flux calculations for ionization chambers and photodiodes<a class="headerlink" href="#x-ray-flux-calculations-for-ionization-chambers-and-photodiodes" title="Link to this heading">¶</a></h2>
<p>Gas-filled ionization chambers are widely used as X-ray detectors. They are
simple to use, inexpensive, and can give highly linear measures of photon flux
over many orders of magnitude.  X-rays entering a chamber filled with an inert
gas (typically He, N2, or one of the noble gases, or a mixture of these) will
be partially absorbed by the gas, with the strong energy dependence shown
above.  By adjusting the composition of the gas, nearly any fraction of the
incident X-ray beam can be absorbed at a particular X-ray energy, making these
ideal detectors to sample the intensity of an X-ray beam incident on a sample,
while attenuating only a fraction of the beam.</p>
<p>Some of the X-rays in the gas will be absorbed by the photo-electric effect
which will <em>ionize</em> the gas, generating free electrons and energetic ions.  The
first ionization event will generate an electron-ion pair with the energy of
the X-ray minus the binding energy of the core electron. The high-energy
electron and ion pair will further ionize other gas molecules.  With an
electric potential (typically on the order of 1 kV /cm) across the plates of
the chamber, a current is generated that is proportional to the X-ray energy
and fluence of the X-rays.</p>
<section id="effective-ionization-potentials-of-gases-and-semiconductors">
<h3>Effective Ionization Potentials of gases and semiconductors<a class="headerlink" href="#effective-ionization-potentials-of-gases-and-semiconductors" title="Link to this heading">¶</a></h3>
<p>The process of converting the X-ray generated current into X-ray fluence
involves several steps. The energy from a single X-ray-generated electron is
converted into a number of electron-ion pairs given by the <em>effective
ionization potential</em> of the gas.  These values are available from a few
sources and range between 20 and 40 eV, given in the <a class="reference internal" href="#xray-ionpot-table"><span class="std std-ref">Table of Effective
Ionization Potentials</span></a>.</p>
<blockquote id="xray-ionpot-table">
<span id="index-0"></span><div><p>Table of Effective Ionization Potentials. Many of these are taken from
<span id="id2">[<a class="reference internal" href="biblio.html#id3" title="G. .F. Knoll. Radiation Detection and Measurement, 4th Edition. John Wiley &amp; Sons, 2010. URL: https://dx.doi.org/10.1002/9780470131480.">Knoll (2010)</a>]</span>, while others appear to come from International Commission
on Radiation Units &amp; Measurement, Report 31, 1979.  The names given are
those supported by the functions <a class="reference internal" href="python.html#xraydb.ionization_potential" title="xraydb.ionization_potential"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionization_potential()</span></code></a> and
<a class="reference internal" href="python.html#xraydb.ionchamber_fluxes" title="xraydb.ionchamber_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionchamber_fluxes()</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>gas/material name(s)</p></th>
<th class="head"><p>potential (eV)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>hydrogen, H</p></td>
<td><p>36.5</p></td>
</tr>
<tr class="row-odd"><td><p>helium, He</p></td>
<td><p>41.3</p></td>
</tr>
<tr class="row-even"><td><p>nitrogen, N, N2</p></td>
<td><p>34.8</p></td>
</tr>
<tr class="row-odd"><td><p>oxygen, O, O2</p></td>
<td><p>30.8</p></td>
</tr>
<tr class="row-even"><td><p>neon, Ne</p></td>
<td><p>35.4</p></td>
</tr>
<tr class="row-odd"><td><p>argon, Ar</p></td>
<td><p>26.4</p></td>
</tr>
<tr class="row-even"><td><p>krypton, Kr</p></td>
<td><p>24.4</p></td>
</tr>
<tr class="row-odd"><td><p>xenon, Xe</p></td>
<td><p>22.1</p></td>
</tr>
<tr class="row-even"><td><p>air</p></td>
<td><p>33.8</p></td>
</tr>
<tr class="row-odd"><td><p>methane, CH4</p></td>
<td><p>27.3</p></td>
</tr>
<tr class="row-even"><td><p>carbondioxide, CO2</p></td>
<td><p>33.0</p></td>
</tr>
<tr class="row-odd"><td><p>silicon, Si</p></td>
<td><p>3.68</p></td>
</tr>
<tr class="row-even"><td><p>germanium, Ge</p></td>
<td><p>2.97</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>From this table, we can see that the absorption (by photo-electric effect) of 1
X-ray with energy 10 keV will generate about 300 electron-ion pairs.  That is
not much current, but if <span class="math notranslate nohighlight">\(10^8 \,\rm Hz\)</span> X-rays are absorbed per second,
then the current generated will be around 5 nA.  Of course, the length of the
gas or more precisely the length of gas under ionizing potential will have an
impact on how much current is generated.  The photo-current generated can be
amplified and converted to a voltage using a current amplifier, and that
voltage will then recorded by a number of possible mean: a voltage-to-frequency
generator and a digital counter is a common method for integrated current for a
specific amount of time, but other sampling methods can also be used.</p>
<p>An ion chamber can be linear over many orders of magnitude of X-ray flux,
provided the potential between the plates is high enough - typically in the 1
kV/cm range to efficiently collect all the charged particles before the
recombine.  As an important practical note, a typical current amplifier at a
particular setting of sensitivity will be linear only over a limited range
(often over an output voltage of 0.02 to 5 V).  Because of this, the
sensitivity of the current amplifier used with an ion chamber needs careful
attention to avoid saturation and maintain sensitivity.</p>
<p>A photo-diode works in much the same way as an ionization chamber.  X-rays
incident on the diode (typically Si or Ge) will be absorbed and generate a
photo-current that can be collected.  Typically PIN diodes are used, and a
small reverse bias voltage is often applied.  Because the electrons do not need
to escape the material but generate a current transported in the semiconductor,
the effective ionization potential is much lower - a few times the
semiconductor band gap instead of a few time the lowest core-level ionization
potential.  The current generated per X-ray will therefore be larger than for
an ion chamber, and will also generally have a much faster response time.  The
generated current will still measured in the same manner as a gas-filled
ionization typically using a current amplifier and integrating counter. Of
course, the thickness of the diode is difficult to adjust.  The active length of
diodes are typically a few hundred microns, and so are generally much more
absorbing than an ion chamber.</p>
</section>
<section id="compton-scattering-and-ion-chamber-current">
<h3>Compton scattering and Ion Chamber Current<a class="headerlink" href="#compton-scattering-and-ion-chamber-current" title="Link to this heading">¶</a></h3>
<p>In addition to photo-electric absorption, X-rays can be attenuated by gas
molecules in an ion chamber by incoherent (Compton) or coherent (Rayleigh)
scattering processes.  The coherent scattering will not generate any electrons
in the gas, but will elastically scatter X-rays out of the main beam.  On the
other hand, incoherent scattering will generate some current, though typically
only a small portion of the incident X-ray energy is given to a scattered
electron.  In fact, Compton scattering has a distribution of energies given to
the scattered electron depending on the angle of scattering, so that the energy
of the scattered electron is</p>
<div class="math notranslate nohighlight">
\[E_{e} = E_{\gamma} - E_{\gamma} / [1 + E_{\gamma}/(m_ec^2)   (1- \cos\theta)]\]</div>
<p>where <span class="math notranslate nohighlight">\(E_{\gamma}\)</span> is the incident X-ray energy, and <span class="math notranslate nohighlight">\(\theta\)</span> is the
scattering angle.  From this, it easy to estimate the median energy of
electrons generated by Compton scattering X-rays of energy <span class="math notranslate nohighlight">\(E\)</span> at 90
degrees will be</p>
<div class="math notranslate nohighlight">
\[E_{\rm median} = E_{\gamma} / (1 + m_ec^2 / E_{\gamma})\]</div>
<p>(recall that <span class="math notranslate nohighlight">\(1 - 1/(1+x) = 1 / (1+1/x)\)</span>).  For X-rays of 10 keV,
<span class="math notranslate nohighlight">\(E_{\rm median}\)</span> is about 192 eV. For 20 keV X-rays, it will be 750 eV,
and for 50 keV X-rays, it will be 4.5 keV.  Because of the angular distribution
of Compton scattering is not uniform, these median values over-estimate the
amount of energy transferred to the scattered electron by a small amount that
increases with energy.  The mean energy of the Compton-scattered electron can
be found by integrating the Klein-Nishina distribution. Since these values
depend only on the incident X-ray energy, these calculations have been done and
the values tabulated in the <cite>Compton_energies</cite> table in the XrayDB sqlite
database.</p>
<p>Although the energy transferred to the electron by Compton scattering is much
less than by the photo-electric process the contribution can be important.
This is especially true for low-Z gas molecules such as He and N2 at
relatively high energies (10 keV and above) for which incoherent scattering
becomes much more important than photo-electric absorption, as shown above
for C. That is, for accurate estimates of fluxes from ion chamber currents at
energies about 20 keV or so, the contribution from Compton scattering should
be included.  For photo-diodes (typically made of Si), the Compton scattering
cross-section exceeds the photo-electric cross-section about 56 keV, and so
should also be included for high-energy X-ray measurements.</p>
</section>
<section id="ion-chamber-flux-calculations">
<h3>Ion Chamber Flux calculations<a class="headerlink" href="#ion-chamber-flux-calculations" title="Link to this heading">¶</a></h3>
<p>The conversion of incident flux at a particular energy to generated current is
not too difficult if considering only the photo-electric effect of a single
gas, but can be somewhat subtle in the more general case.  For the discussion
here, we assume that the potential across the plates of the ion chamber is high
enough to prevent any recombination of charged particles.</p>
<p>For a given gas at an incident X-ray energy <span class="math notranslate nohighlight">\(E\)</span>, we calculate the total,
photo-electric, incoherent (Compton), and coherent (Rayleigh) values of
<span class="math notranslate nohighlight">\(\mu\)</span>.  If more than one gas is used, the weighted sum is calculated, so
that we have <span class="math notranslate nohighlight">\(\mu_{\rm total}\)</span>, <span class="math notranslate nohighlight">\(\mu_{\rm photo}\)</span>,
<span class="math notranslate nohighlight">\(\mu_{\rm incoh}\)</span>, and <span class="math notranslate nohighlight">\(\mu_{\rm coh}\)</span> for the gas in the
chamber or diode material.</p>
<p>The flux transmitted out of the chamber is</p>
<div class="math notranslate nohighlight">
\[I_{\rm trans} = I_0 e^{-t \mu_{\rm total}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the length of the chamber and <span class="math notranslate nohighlight">\(I_{0}\)</span> is the incident
flux.  These two intensities are the quantity we are most interested in.  The
attenuated flux (in number per second, or Hz) is</p>
<div class="math notranslate nohighlight">
\[I_{\rm atten} = I_0 (1 - e^{-t \mu_{\rm total}})\]</div>
<p>can be separated into the various source of attenuation as</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
   &amp; I_{\rm photo} &amp; =  I_{\rm atten} \, \mu_{\rm photo} / \mu_{\rm total} \\
   &amp; I_{\rm incoh} &amp; =  I_{\rm atten} \, \mu_{\rm incoh} / \mu_{\rm total} \\
   &amp; I_{\rm coh}   &amp; =  I_{\rm atten} \, \mu_{\rm coh}   / \mu_{\rm total} \\
\end{eqnarray*}</div><p>The photo-electric effect converts all of the X-ray energy into a current of
both electrons and ions using the effective ionization potential above:</p>
<div class="math notranslate nohighlight">
\[C_{\rm photo} = 2 q_e E I_{\rm photo} / V_{\rm eff}\]</div>
<p>where <span class="math notranslate nohighlight">\(q_{e}\)</span> is the electron charge (<span class="math notranslate nohighlight">\(1.6\times10^{-19} \rm{C}\)</span>),
<span class="math notranslate nohighlight">\(E\)</span> is the incident X-ray energy (in eV), <span class="math notranslate nohighlight">\(I_{\rm photo}\)</span> is the
flux (in Hz), and <span class="math notranslate nohighlight">\(V_{\rm eff}\)</span> is the effective ionization potential for
the gas.  The leading 2 comes because both electrons and ions are typically
counted for the current from an ion chamber.  It is sometimes useful to add a
Frisch mesh grid to collect the slower ions and shunt them so as to not count
that portion of the current, and thereby give the ion chamber a faster time
response.  In that case, the current will be half of the value given above.</p>
<p>As discussed above, the coherent (Rayleigh) scattering produces no electrons,
but the incoherent (Compton) scattering does, and the energy of the the
Compton-scattered electron varies with both X-ray energy and scattering angle,
as does the probability of scattering. Integrating over all angles (and
assuming the ion chamber is large enough to stop the scattered electrons) gives
the mean electron energy, which we use to obtain the current from the
incoherent scattering:</p>
<div class="math notranslate nohighlight">
\[C_{\rm incoh} = 2 q_e E_{\rm mean}  I_{\rm incoh} / V_{\rm eff}\]</div>
<p>where <span class="math notranslate nohighlight">\(E_{\rm mean}\)</span> is the mean energy of Compton-scattered
electron (approximately, but slightly less than the <span class="math notranslate nohighlight">\(E_{\rm median}\)</span>
value above.</p>
<p>The current from an ion_chamber is typically measured as a voltage generated by
a current-to-voltage amplifier. The measured voltage will have a gain or
sensitivity in units of <cite>A/V</cite>.  The goal is typically to calculate the flux
<span class="math notranslate nohighlight">\(I_0\)</span> from the measured voltage and knowledge of the sensitivity as well
as the gas(es), ion chamber length <span class="math notranslate nohighlight">\(t\)</span>, and X-ray energy <span class="math notranslate nohighlight">\(E\)</span>.  The
measured voltage is given by</p>
<div class="math notranslate nohighlight">
\[V  = I_0 ( C_{\rm photo} + C_{\rm incoh} ) / S\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is the amplifier sensitivity in A/V.  From this, <span class="math notranslate nohighlight">\(I_0\)</span>
and <span class="math notranslate nohighlight">\(I_{\rm trans}\)</span> can be calculated.</p>
</section>
<section id="ionchamber-fluxes">
<h3><a class="reference internal" href="python.html#xraydb.ionchamber_fluxes" title="xraydb.ionchamber_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionchamber_fluxes()</span></code></a><a class="headerlink" href="#ionchamber-fluxes" title="Link to this heading">¶</a></h3>
<p>The function <a class="reference internal" href="python.html#xraydb.ionchamber_fluxes" title="xraydb.ionchamber_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionchamber_fluxes()</span></code></a> will calculate X-ray fluxes
for an ion chamber as described above the following inputs:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>gas</cite>: the gas, or mixture of gases used or ‘Si’ or ‘Ge’ for diodes.</p></li>
<li><p><cite>length</cite>: the length of the ion chamber, in cm.</p></li>
<li><p><cite>energy</cite>: the X-ray energy, in eV.</p></li>
<li><p><cite>volts</cite>: the output voltage of the current amplifier</p></li>
<li><p><cite>sensitivity</cite> and <cite>sensitivity_units</cite>: the sensitivity or gain of the
amplifier used to convert the photo-current to the recorded voltage.</p></li>
<li><p><cite>with_compton</cite>:  whether to include the current generated by
Compton-scattered electrons [True]</p></li>
<li><p><cite>both_carriers</cite>:  whether to include the current generated by both positive
and negative charged particles [True]</p></li>
</ul>
</div></blockquote>
<p>The default <cite>sensitivity_units</cite> is ‘A/V’ but can be set to any of the
common SI prefixes such as ‘p’, ‘pico’, ‘n’, ‘nano’, <span class="math notranslate nohighlight">\(\mu\)</span>,
(unicode ‘03bc’), ‘u’, ‘micro’, ‘m’, or ‘milli’, so that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span> <span class="o">=</span> <span class="n">ionchamber_fluxes</span><span class="p">(</span><span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="n">volts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="go">                               sensitivity=1.e-9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span> <span class="o">=</span> <span class="n">ionchamber_fluxes</span><span class="p">(</span><span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="n">volts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="go">                               sensitivity=1, sensitivity_units=&#39;nA/V&#39;)</span>
</pre></div>
</div>
<p>will give the same results.</p>
<p>The output from  <a class="reference internal" href="python.html#xraydb.ionchamber_fluxes" title="xraydb.ionchamber_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionchamber_fluxes()</span></code></a> is a named tuple with 4 fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>photo</cite>  -  the flux absorbed by the photo-electric effect, in Hz.</p></li>
<li><p><cite>incoherent</cite>  -  the flux scattered by the Compton effects, in Hz.</p></li>
<li><p><cite>incident</cite> - the flux incident on the ion chamber, in Hz.</p></li>
<li><p><cite>transmitted</cite> - the flux beam leaving the ion chamber, in Hz.</p></li>
</ul>
</div></blockquote>
<p>As described above, the current in the ion chamber or photo-diode is generated
by electrons and ions produced by both the photo-electric and incoherent or
Compton scattering.  The photo-electric cross-section will dominate for heavy
elements and relatively low X-ray energies, but does not necessarily dominate
at high X-ray energies. The photo-electric cross-section with the incident
X-ray energy and the incoherent cross-section with the <strong>*mean*</strong>
Compton-scattering energy, using the calculated and tabulated mean energies of
the Compton-scattered electrons are used to estimate the incident flux from
the photo-current. The total attenuation cross-section, including the coherent
cross-sections, is used to calculate the transmitted flu from the incident
flux.</p>
<p>As an example calculation of ion chamber currents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span> <span class="o">=</span> <span class="n">ionchamber_fluxes</span><span class="p">(</span><span class="n">gas</span><span class="o">=</span><span class="s1">&#39;nitrogen&#39;</span><span class="p">,</span> <span class="n">volts</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mi">18000</span><span class="p">,</span>
<span class="go">                               length=10.0, sensitivity=1.e-6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incident= </span><span class="si">{</span><span class="n">fl</span><span class="o">.</span><span class="n">incident</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> Hz, Transmitted flux= </span><span class="si">{</span><span class="n">fl</span><span class="o">.</span><span class="n">transmitted</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="go">Incident= 2.2358e+12 Hz, Transmitted flux= 2.214e+12 Hz</span>
</pre></div>
</div>
<p>It is not uncommon for an ion chamber to be filled with a mixture of 2 or
more gases so as to better control the fraction of X-rays absorbed in a
chamber of fixed length. This can be specified by passing in a dictionary
of gas name and fractional density, as with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span> <span class="o">=</span> <span class="n">ionchamber_fluxes</span><span class="p">(</span><span class="n">gas</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Kr&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">volts</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span>
<span class="go">                           energy=18000, length=10,</span>
<span class="go">                           sensitivity=1, sensitivity_units=&#39;microA/V&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incident= </span><span class="si">{</span><span class="n">fl</span><span class="o">.</span><span class="n">incident</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> Hz, Transmitted flux= </span><span class="si">{</span><span class="n">fl</span><span class="o">.</span><span class="n">transmitted</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="go">Incident= 1.43737e+10 Hz, Transmitted flux= 3.28986e+09 Hz</span>
</pre></div>
</div>
<p>Finally, the pressure of the gas is sometimes adjusted to alter the
fraction of the beam absorbed.  The calculations here all use the densities
at STP, but changes in gas density will be exactly linear to changing the
length of the ion chamber.</p>
</section>
</section>
<section id="x-ray-mirror-reflectivities">
<h2>X-ray mirror reflectivities<a class="headerlink" href="#x-ray-mirror-reflectivities" title="Link to this heading">¶</a></h2>
<p>At very shallow angles of incidence X-rays can be reflected by total
external reflection from a material. The reflectivity can be very high
at relatively low energies and shallow angles, but drops off dramatically
with increasing energy, increasing angle, and decreasing electron density.
Still, this reflectivity is one of the few ways to steer X-ray beams and so
is widely used in synchrotron radiation sources.</p>
<p>The reflectivity can be calculated with the <a class="reference internal" href="python.html#xraydb.mirror_reflectivity" title="xraydb.mirror_reflectivity"><code class="xref py py-func docutils literal notranslate"><span class="pre">mirror_reflectivity()</span></code></a>
function which takes X-ray energy, incident angle, and mirror material as
arguments.</p>
<p>An example script, comparing the energy-dependence of the reflectivity for
a few common mirror materials is given as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">xraydb</span> <span class="kn">import</span> <span class="n">mirror_reflectivity</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">51000</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>

<span class="n">r_si</span> <span class="o">=</span> <span class="n">mirror_reflectivity</span><span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>
<span class="n">r_ni</span> <span class="o">=</span> <span class="n">mirror_reflectivity</span><span class="p">(</span><span class="s1">&#39;Ni&#39;</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>
<span class="n">r_rh</span> <span class="o">=</span> <span class="n">mirror_reflectivity</span><span class="p">(</span><span class="s1">&#39;Rh&#39;</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>
<span class="n">r_pt</span> <span class="o">=</span> <span class="n">mirror_reflectivity</span><span class="p">(</span><span class="s1">&#39;Pt&#39;</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">energy</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">r_si</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Si&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">r_ni</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ni&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">r_rh</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rh&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">r_pt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pt&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;X-ray reflectivity at $</span><span class="se">\\</span><span class="s1">theta=2 \mathrm</span><span class="si">{mrad}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectivity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id9">
<span id="fig-mirrors"></span><a class="reference external image-reference" href="_images/mirrors.png"><img alt="_images/mirrors.png" src="_images/mirrors.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">X-ray mirror reflectivity at <span class="math notranslate nohighlight">\(\theta = 2\mathrm{mrad}\)</span> for
selected mirror surfaces and coatings used for mirrors.</span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="darwin-widths-of-monochromator-crystals">
<h2>Darwin widths of monochromator crystals<a class="headerlink" href="#darwin-widths-of-monochromator-crystals" title="Link to this heading">¶</a></h2>
<p>Bragg’s law describes X-ray diffraction from crystals as</p>
<div class="math notranslate nohighlight">
\[m \lambda = 2 d \sin(\theta)\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is the X-ray wavelength, <span class="math notranslate nohighlight">\(d\)</span> the d-spacing of
the crystal lattice plane, <span class="math notranslate nohighlight">\(\theta\)</span> the incident angle, and <span class="math notranslate nohighlight">\(m\)</span>
the order of the reflection.  For imperfect crystals, in which the lattice
planes are not stacked perfectly over extended distances, the angular width
of any particular reflection is dominated by the spread in d-spacing and
the mosaicity inherent in the crystal.  For perfect crystals, however, the
angular width of a reflection is dominated by the fact that effectively all
of the X-rays will scatter from the lattice well before any attenuation of
the X-ray beam occurs. This <em>dynamical</em> diffraction gives a small but
finite offset from the Bragg angle, and gives a broadened angular width to
reflection.  This is usually called the Darwin width (named for
Charles G. Darwin, grandson of the more famous Charles R. Darwin).  In
addition, the refraction and in particular the absorption effects that give
anomalous scattering (as calculated with <a class="reference internal" href="python.html#xraydb.xray_delta_beta" title="xraydb.xray_delta_beta"><code class="xref py py-func docutils literal notranslate"><span class="pre">xray_delta_beta()</span></code></a>) make the
“rocking curve” of reflected intensity as a function of angle an asymmetric
shape.</p>
<p>All of these effects are included in the <a class="reference internal" href="python.html#xraydb.darwin_width" title="xraydb.darwin_width"><code class="xref py py-func docutils literal notranslate"><span class="pre">darwin_width()</span></code></a> function,
which follows very closely the description from chapter 6.4 in
<span id="id3">[<a class="reference internal" href="biblio.html#id2" title="J. Als-Nielsen and D. McMorrow. Elements of Modern X-ray Physics, 2nd Edition. John Wiley &amp; Sons, 2011. URL: https://dx.doi.org/10.1002/9781119998365.">Als-Nielsen and McMorrow (2011)</a>]</span>.  The function takes inputs of</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>energy</cite>: the X-ray energy, in eV.</p></li>
<li><p><cite>crystal</cite>: the atomic symbol for the crystal: ‘Si’, ‘Ge’, or ‘C’. [‘Si’]</p></li>
<li><p><cite>hkl</cite>: a tuple with (h, k, l) of the reflection used. [(1, 1, 1)]</p></li>
<li><p><cite>a</cite>: lattice constant [<cite>None</cite> - use nominal value for crystal]</p></li>
<li><p><cite>polarization</cite>: <cite>s</cite>, <cite>p</cite>, or <cite>u</cite> to specify the X-ray polarization relative to the crystal [<cite>s</cite>]</p></li>
<li><p><cite>m</cite>: the order of the reflection. [1]</p></li>
<li><p><cite>ignore_f1</cite>: whether to ignore <cite>f1</cite>. [False]</p></li>
<li><p><cite>ignore_f2</cite>: whether to ignore <cite>f2</cite>. [False]</p></li>
</ul>
</div></blockquote>
<p>Polarization of <cite>s</cite> should be used for vertically deflecting monochromators
at most synchrotron sources (which will normally be horizontally
polarized), and <cite>p</cite> should be used for horizontally deflecting
monochromators.  For crystals used to analyzed unpolarized X-ray emission,
use <cite>u</cite>, which will give the average of <cite>s</cite> and <cite>p</cite> polarization.</p>
<p>As with <a class="reference internal" href="python.html#xraydb.ionchamber_fluxes" title="xraydb.ionchamber_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionchamber_fluxes()</span></code></a>, the output here is complicated enough
that it is put into a named <cite>DarwinWidth</cite> tuple that will contain the
following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>theta</cite> - the nominal Bragg angle, in rad</p></li>
<li><p><cite>theta_offset</cite> - the offset from the nominal Bragg angle, in rad.</p></li>
<li><p><cite>theta_width</cite> - estimated angular Darwin width, in rad</p></li>
<li><p><cite>theta_fwhm</cite> - estimated FWHM of the angular reflectivity curve, in rad</p></li>
<li><p><cite>energy_width</cite> - estimated energy Darwin width, in eV</p></li>
<li><p><cite>energy_fwhm</cite> - estimated FWHM energy reflectivity curve, in eV</p></li>
<li><p><cite>zeta</cite> -  nd-array of <span class="math notranslate nohighlight">\(\zeta = \Delta\lambda/\lambda\)</span>.</p></li>
<li><p><cite>dtheta</cite>  - nd-array of angles around from Bragg angle, in rad</p></li>
<li><p><cite>denergy</cite> -  nd-array of energies around from Bragg energy, in eV</p></li>
<li><p><cite>intensity</cite> - nd-array of reflected intensity at <cite>zeta</cite> values.</p></li>
</ul>
</div></blockquote>
<p>Here, <cite>dtheta</cite> will be given by <span class="math notranslate nohighlight">\(\Delta\theta = \zeta \tan(\theta)\)</span>,
and <cite>denergy</cite> will be given by <span class="math notranslate nohighlight">\(\Delta{E} = \zeta E\)</span>.  All of the
nd-arrays will be the same size, so that plots of reflectivity can be
readily made.  An example usage, printing the predicted energy and angular
widths and plotting the intensity profile or “rocking curve” is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">xraydb</span> <span class="kn">import</span> <span class="n">darwin_width</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dw_si111</span> <span class="o">=</span> <span class="n">darwin_width</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">dw_si333</span> <span class="o">=</span> <span class="n">darwin_width</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">fmt_string</span> <span class="o">=</span> <span class="s2">&quot;Darwin Width for </span><span class="si">{:s}</span><span class="s2"> at </span><span class="si">{:.0f}</span><span class="s2"> keV: </span><span class="si">{:5.2f}</span><span class="s2"> microrad, </span><span class="si">{:5.2f}</span><span class="s2"> eV&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmt_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Si(111)&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
                        <span class="n">dw_si111</span><span class="o">.</span><span class="n">theta_width</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span>
                        <span class="n">dw_si111</span><span class="o">.</span><span class="n">energy_width</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="n">fmt_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Si(333)&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
                        <span class="n">dw_si333</span><span class="o">.</span><span class="n">theta_width</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span>
                        <span class="n">dw_si333</span><span class="o">.</span><span class="n">energy_width</span><span class="p">))</span>

<span class="n">dtheta</span>  <span class="o">=</span> <span class="n">dw_si111</span><span class="o">.</span><span class="n">dtheta</span><span class="o">*</span><span class="mf">1e6</span>
<span class="n">denergy</span> <span class="o">=</span> <span class="n">dw_si111</span><span class="o">.</span><span class="n">denergy</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">#  slightly advanced matplotlib hackery:</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dtheta</span><span class="p">,</span> <span class="n">dw_si111</span><span class="o">.</span><span class="n">intensity</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$I$, Si(111)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dtheta</span><span class="p">,</span> <span class="n">dw_si111</span><span class="o">.</span><span class="n">intensity</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$I^2$, Si(111)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dw_si333</span><span class="o">.</span><span class="n">dtheta</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">dw_si333</span><span class="o">.</span><span class="n">intensity</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$I^2$ Si(333) 30 keV&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;X-ray diffraction intensity at 10keV&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Angle - $</span><span class="se">\\</span><span class="s1">theta_B$ ($ \mu \mathrm</span><span class="si">{rad}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectivity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>which will print out values of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Darwin</span> <span class="n">Width</span> <span class="k">for</span> <span class="n">Si</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span> <span class="n">at</span> <span class="mi">10</span> <span class="n">keV</span><span class="p">:</span> <span class="mf">26.96</span> <span class="n">microrad</span><span class="p">,</span>  <span class="mf">1.34</span> <span class="n">eV</span>
<span class="n">Darwin</span> <span class="n">Width</span> <span class="k">for</span> <span class="n">Si</span><span class="p">(</span><span class="mi">333</span><span class="p">)</span> <span class="n">at</span> <span class="mi">30</span> <span class="n">keV</span><span class="p">:</span>  <span class="mf">1.81</span> <span class="n">microrad</span><span class="p">,</span>  <span class="mf">0.27</span> <span class="n">eV</span>
</pre></div>
</div>
<p>and generates a plot of</p>
<figure class="align-center" id="id10">
<span id="fig-darwin"></span><a class="reference external image-reference" href="_images/darwin_widths.png"><img alt="_images/darwin_widths.png" src="_images/darwin_widths.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">X-ray monochromator diffracted intensities around the Si(111)
reflection. Here, <span class="math notranslate nohighlight">\(i\)</span> represents the intensity of a single
reflection, and <span class="math notranslate nohighlight">\(i^2\)</span> the intensity from 2 bounces, as for a
double-crystal monochromator.  The intensity and angular offset of the
third harmonic is also shown.</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Note that the values reported for <cite>theta_fwhm</cite> and <cite>energy_fwhm</cite> will be
about 6% larger than the reported values for <cite>theta_width</cite> and
<cite>energy_width</cite>.  The <cite>width</cite> values closely follow the region of the curve
where the reflectivity ignoring absorption would be 1 - the flat top of the
curve.  Since a double-crystal monochromator will suppress the tails of the
reflectivity, this smaller value is the one typically reported as “the
Darwin width”, though some sources will report this smaller value as “FWHM”.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Example Calculations of X-ray properties of materials</a><ul>
<li><a class="reference internal" href="#x-ray-attenuation-by-elements">X-ray attenuation by elements</a></li>
<li><a class="reference internal" href="#mu-calculations-for-materials"><span class="math notranslate nohighlight">\(\mu\)</span> calculations for materials</a></li>
<li><a class="reference internal" href="#x-ray-flux-calculations-for-ionization-chambers-and-photodiodes">X-ray flux calculations for ionization chambers and photodiodes</a><ul>
<li><a class="reference internal" href="#effective-ionization-potentials-of-gases-and-semiconductors">Effective Ionization Potentials of gases and semiconductors</a></li>
<li><a class="reference internal" href="#compton-scattering-and-ion-chamber-current">Compton scattering and Ion Chamber Current</a></li>
<li><a class="reference internal" href="#ion-chamber-flux-calculations">Ion Chamber Flux calculations</a></li>
<li><a class="reference internal" href="#ionchamber-fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ionchamber_fluxes()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#x-ray-mirror-reflectivities">X-ray mirror reflectivities</a></li>
<li><a class="reference internal" href="#darwin-widths-of-monochromator-crystals">Darwin widths of monochromator crystals</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="periodictable.html"
                          title="previous chapter">X-ray Periodic Table of the Elements</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="python.html"
                          title="next chapter">Using XrayDB from Python</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="python.html" title="Using XrayDB from Python"
             >next</a> |</li>
        <li class="right" >
          <a href="periodictable.html" title="X-ray Periodic Table of the Elements"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">X-ray DB:  X-ray Reference Data in SQLite</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Example Calculations of X-ray properties of materials</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright Public Domain.
      Last updated on 2024-November-01.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.6.
    </div>
  </body>
</html>